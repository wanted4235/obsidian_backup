# üìå –ö–æ–Ω—Å–ø–µ–∫—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π CASE –≤ PL/pgSQL

–í —è–∑—ã–∫–µ **PL/pgSQL** –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `CASE` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ **—É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏**, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º `IF/ELSIF/ELSE`, –Ω–æ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ **—á–∏—Ç–∞–µ–º—ã–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥**, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç **—Ç—Ä–∏ —Ñ–æ—Ä–º—ã** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `CASE`:

1. **–ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞ CASE**
2. **–ü–æ–∏—Å–∫–æ–≤–∞—è (–ø–æ —É—Å–ª–æ–≤–∏—é) –∫–æ–º–∞–Ω–¥–∞ CASE**
3. **–í—ã—Ä–∞–∂–µ–Ω–∏–µ CASE**

---

## üîπ 1. –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞ CASE

–≠—Ç–∞ —Ñ–æ—Ä–º–∞ `CASE` —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç **–æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ** —Å–æ —Å–ø–∏—Å–∫–æ–º –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
CASE –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
    WHEN –∑–Ω–∞—á–µ–Ω–∏–µ1 THEN
        -- –¥–µ–π—Å—Ç–≤–∏—è
    WHEN –∑–Ω–∞—á–µ–Ω–∏–µ2 THEN
        -- –¥–µ–π—Å—Ç–≤–∏—è
    ...
    [ELSE
        -- –¥–µ–π—Å—Ç–≤–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é]
END CASE;
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    grade CHAR(1) := 'B';
BEGIN
    CASE grade
        WHEN 'A' THEN
            RAISE NOTICE '–û—Ç–ª–∏—á–Ω–æ!';
        WHEN 'B' THEN
            RAISE NOTICE '–•–æ—Ä–æ—à–æ!';
        WHEN 'C' THEN
            RAISE NOTICE '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ';
        ELSE
            RAISE NOTICE '–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ';
    END CASE;
END $$;
```

üìå –≠—Ç–∞ —Ñ–æ—Ä–º–∞ —É–¥–æ–±–Ω–∞, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º.

---

## üîπ 2. –ü–æ–∏—Å–∫–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ CASE

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º—ã, **–ø–æ–∏—Å–∫–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ CASE** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —É—Å–ª–æ–≤–∏—è** (`>`, `<`, `IS NULL`, `BETWEEN` –∏ —Ç.–¥.).

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
CASE
    WHEN —É—Å–ª–æ–≤–∏–µ1 THEN
        -- –¥–µ–π—Å—Ç–≤–∏—è
    WHEN —É—Å–ª–æ–≤–∏–µ2 THEN
        -- –¥–µ–π—Å—Ç–≤–∏—è
    ...
    [ELSE
        -- –¥–µ–π—Å—Ç–≤–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é]
END CASE;
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    score INTEGER := 75;
BEGIN
    CASE
        WHEN score >= 90 THEN
            RAISE NOTICE '–û—Ç–ª–∏—á–Ω–æ!';
        WHEN score BETWEEN 75 AND 89 THEN
            RAISE NOTICE '–•–æ—Ä–æ—à–æ!';
        WHEN score BETWEEN 60 AND 74 THEN
            RAISE NOTICE '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ';
        ELSE
            RAISE NOTICE '–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ';
    END CASE;
END $$;
```

üìå –¢–∞–∫–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–ª–µ–∑–Ω–∞, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ **–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π –∏–ª–∏ —Å–ª–æ–∂–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π**.

---

## üîπ 3. –í—ã—Ä–∞–∂–µ–Ω–∏–µ CASE

–í—ã—Ä–∞–∂–µ–Ω–∏–µ `CASE` ‚Äî —ç—Ç–æ –Ω–µ –±–ª–æ–∫, –∞ **–≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
CASE
    WHEN —É—Å–ª–æ–≤–∏–µ1 THEN –∑–Ω–∞—á–µ–Ω–∏–µ1
    WHEN —É—Å–ª–æ–≤–∏–µ2 THEN –∑–Ω–∞—á–µ–Ω–∏–µ2
    ...
    ELSE –∑–Ω–∞—á–µ–Ω–∏–µ_–ø–æ_—É–º–æ–ª—á–∞–Ω–∏—é
END
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    age INTEGER := 25;
    category TEXT;
BEGIN
    category := CASE
                    WHEN age < 13 THEN '–†–µ–±—ë–Ω–æ–∫'
                    WHEN age BETWEEN 13 AND 19 THEN '–ü–æ–¥—Ä–æ—Å—Ç–æ–∫'
                    WHEN age BETWEEN 20 AND 64 THEN '–í–∑—Ä–æ—Å–ª—ã–π'
                    ELSE '–ü–µ–Ω—Å–∏–æ–Ω–µ—Ä'
                END;

    RAISE NOTICE '–ö–∞—Ç–µ–≥–æ—Ä–∏—è: %', category;
END $$;
```

üìå –≠—Ç–æ –æ—á–µ–Ω—å –º–æ—â–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ SELECT** –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

| –°–æ–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| –ò—Å–ø–æ–ª—å–∑—É–π `CASE` –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ `IF/ELSIF`, –µ—Å–ª–∏ –µ—Å—Ç—å –º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ | –£–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ |
| –ù–µ –∑–∞–±—ã–≤–∞–π –∑–∞–∫—Ä—ã–≤–∞—Ç—å `CASE` –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º `END CASE;` –∏–ª–∏ `END;` | –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| –ü—Ä–æ–≤–µ—Ä—è–π –ø–æ—Ä—è–¥–æ–∫ —É—Å–ª–æ–≤–∏–π –≤ `CASE` | –ü–µ—Ä–≤–æ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ —É—Å–ª–æ–≤–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–ª—å–Ω–µ–π—à—É—é –ø—Ä–æ–≤–µ—Ä–∫—É |
| –ò—Å–ø–æ–ª—å–∑—É–π `CASE` –≤ SQL-–∑–∞–ø—Ä–æ—Å–∞—Ö | –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö |

---

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –§–æ—Ä–º–∞ `CASE` | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|--------------|---------------------|
| –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞ `CASE` | –ö–æ–≥–¥–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ |
| –ü–æ–∏—Å–∫–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ `CASE` | –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π (`>`, `<`, `BETWEEN`) |
| –í—ã—Ä–∞–∂–µ–Ω–∏–µ `CASE` | –í SQL-–∑–∞–ø—Ä–æ—Å–∞—Ö –∏–ª–∏ –ø—Ä–∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏—è |

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `CASE` ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ PL/pgSQL –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ **—É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏** –∫–∞–∫ –≤ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö, —Ç–∞–∫ –∏ –≤ SQL-–∑–∞–ø—Ä–æ—Å–∞—Ö.

---
