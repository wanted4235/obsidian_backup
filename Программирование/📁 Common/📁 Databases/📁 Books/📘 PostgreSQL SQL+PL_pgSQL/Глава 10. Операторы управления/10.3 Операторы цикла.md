# üìå –ö–æ–Ω—Å–ø–µ–∫—Ç: –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Ü–∏–∫–ª–∞ –≤ PL/pgSQL

–¶–∏–∫–ª—ã –≤ —è–∑—ã–∫–µ **PL/pgSQL** –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –±–ª–æ–∫–∏ –∫–æ–¥–∞ **–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ**, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç **—Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ —Ü–∏–∫–ª–æ–≤**:

1. **–ü—Ä–æ—Å—Ç–æ–π —Ü–∏–∫–ª `LOOP`**
2. **–¶–∏–∫–ª `WHILE`**
3. **–¶–∏–∫–ª `FOR`**

–¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω—ã **–≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã**, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω —Ü–∏–∫–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–æ–≥–æ.

---

## üîπ 1. –ü—Ä–æ—Å—Ç–æ–π —Ü–∏–∫–ª LOOP

–≠—Ç–æ —Å–∞–º—ã–π –±–∞–∑–æ–≤—ã–π —Ç–∏–ø —Ü–∏–∫–ª–∞ ‚Äî –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ**, –ø–æ–∫–∞ —è–≤–Ω–æ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–µ—Ä–≤–∞–Ω –∫–æ–º–∞–Ω–¥–æ–π `EXIT`.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
LOOP
    -- —Ç–µ–ª–æ —Ü–∏–∫–ª–∞
    EXIT WHEN —É—Å–ª–æ–≤–∏–µ_–≤—ã—Ö–æ–¥–∞;
END LOOP;
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    counter INTEGER := 1;
BEGIN
    LOOP
        RAISE NOTICE '–°—á—ë—Ç—á–∏–∫: %', counter;
        counter := counter + 1;
        EXIT WHEN counter > 5;
    END LOOP;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: –°—á—ë—Ç—á–∏–∫: 1
NOTICE: –°—á—ë—Ç—á–∏–∫: 2
NOTICE: –°—á—ë—Ç—á–∏–∫: 3
NOTICE: –°—á—ë—Ç—á–∏–∫: 4
NOTICE: –°—á—ë—Ç—á–∏–∫: 5
```

> ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å `EXIT`, —Ü–∏–∫–ª —Å—Ç–∞–Ω–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º!

---

## üîπ 2. –¶–∏–∫–ª WHILE

–¶–∏–∫–ª `WHILE` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –∏—Å—Ç–∏–Ω–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ**.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
WHILE —É—Å–ª–æ–≤–∏–µ LOOP
    -- —Ç–µ–ª–æ —Ü–∏–∫–ª–∞
END LOOP;
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    counter INTEGER := 1;
BEGIN
    WHILE counter <= 5 LOOP
        RAISE NOTICE '–°—á—ë—Ç—á–∏–∫: %', counter;
        counter := counter + 1;
    END LOOP;
END $$;
```

üìå –≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π, –Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

---

## üîπ 3. –¶–∏–∫–ª FOR

–¶–∏–∫–ª `FOR` —É–¥–æ–±–µ–Ω –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ —á–∏—Å–ª–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É SQL-–∑–∞–ø—Ä–æ—Å–∞.

### a) –ß–∏—Å–ª–æ–≤–æ–π —Ü–∏–∫–ª FOR

–í—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ç–µ—Ä–∞—Ü–∏–∏ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –¥–æ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

#### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
FOR –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è IN [REVERSE] –Ω–∞—á–∞–ª—å–Ω–æ–µ..–∫–æ–Ω–µ—á–Ω–æ–µ LOOP
    -- —Ç–µ–ª–æ —Ü–∏–∫–ª–∞
END LOOP;
```

#### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
BEGIN
    FOR i IN 1..5 LOOP
        RAISE NOTICE '–ß–∏—Å–ª–æ: %', i;
    END LOOP;
END $$;
```

üìå –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `REVERSE`, —á—Ç–æ–±—ã –∏–¥—Ç–∏ –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É:
```sql
FOR i IN REVERSE 5..1 LOOP
    ...
END LOOP;
```

---

### b) –¶–∏–∫–ª FOR –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∑–∞–ø—Ä–æ—Å–∞

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞.

#### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```sql
FOR –∑–∞–ø–∏—Å—å IN SELECT ... LOOP
    -- –¥–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–ø–∏—Å—å—é
END LOOP;
```

#### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    emp RECORD;
BEGIN
    FOR emp IN SELECT * FROM employees WHERE salary > 5000 LOOP
        RAISE NOTICE '–°–æ—Ç—Ä—É–¥–Ω–∏–∫: %, –ó–∞—Ä–ø–ª–∞—Ç–∞: %', emp.name, emp.salary;
    END LOOP;
END $$;
```

üìå –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ –∫—É—Ä—Å–æ—Ä–æ–≤.

---

## üîπ 4. –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã

–í PL/pgSQL –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ü–∏–∫–ª—ã –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–∏—Ö —Ü–∏–∫–ª–æ–≤** ‚Äî —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏**.

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    i INTEGER;
    j INTEGER;
BEGIN
    FOR i IN 1..3 LOOP
        FOR j IN 1..2 LOOP
            RAISE NOTICE 'i = %, j = %', i, j;
        END LOOP;
    END LOOP;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: i = 1, j = 1
NOTICE: i = 1, j = 2
NOTICE: i = 2, j = 1
NOTICE: i = 2, j = 2
NOTICE: i = 3, j = 1
NOTICE: i = 3, j = 2
```

> üí° –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ **–æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** ‚Äî –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤–æ –≤–Ω–µ—à–Ω–µ–º –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ü–∏–∫–ª–µ, –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞.

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

| –°–æ–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| –ò—Å–ø–æ–ª—å–∑—É–π `EXIT` –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ `LOOP` | –ë–µ–∑ –Ω–µ–≥–æ —Ü–∏–∫–ª –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º |
| –ù–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ | –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –≤ `LOOP` –∏ `WHILE` |
| –¶–∏–∫–ª `FOR` –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä–∞ —Å—Ç—Ä–æ–∫ | –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω –∏ —É–¥–æ–±–µ–Ω |
| –ò–∑–±–µ–≥–∞–π –≥–ª—É–±–æ–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ | –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ |
| –¢–µ—Å—Ç–∏—Ä—É–π –ª–æ–≥–∏–∫—É —Ü–∏–∫–ª–æ–≤ –Ω–∞ –º–∞–ª—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö | –ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã |

---

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –¢–∏–ø —Ü–∏–∫–ª–∞ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----------|---------------------|
| `LOOP` | –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –Ω–∞—á–∞–ª–æ–º –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º —Ü–∏–∫–ª–∞ |
| `WHILE` | –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —É—Å–ª–æ–≤–∏–µ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π |
| `FOR` | –î–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ —á–∏—Å–ª–æ–≤–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É SQL-–∑–∞–ø—Ä–æ—Å–∞ |
| –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã | –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö |

–¶–∏–∫–ª—ã ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ PL/pgSQL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä—è–º–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

