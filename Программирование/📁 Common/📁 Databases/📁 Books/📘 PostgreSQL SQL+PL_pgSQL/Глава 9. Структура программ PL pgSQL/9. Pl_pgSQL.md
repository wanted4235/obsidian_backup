## üîπ –í–≤–µ–¥–µ–Ω–∏–µ –≤ PL/pgSQL

**PL/pgSQL (Procedural Language/PostgreSQL)** ‚Äî —ç—Ç–æ **–ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è**, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ –°–£–ë–î **PostgreSQL**.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:
  - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  - –£—Å–ª–æ–≤–∏—è (`IF`, `CASE`)
  - –¶–∏–∫–ª—ã (`LOOP`, `FOR`, `WHILE`)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—á–µ—Ç–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã —Å –ª–æ–≥–∏–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:
  - **–•—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä**
  - **–§—É–Ω–∫—Ü–∏–π**
  - **–¢—Ä–∏–≥–≥–µ—Ä–æ–≤**

---

## üîπ –•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã

| –û–±—ä–µ–∫—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|--------|------------|-------------|
| **–ü—Ä–æ—Ü–µ–¥—É—Ä–∞** | –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ) | –ù–µ –æ–±—è–∑–∞–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ |
| **–§—É–Ω–∫—Ü–∏—è** | –í—ã—á–∏—Å–ª—è–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–∫–∞–ª—è—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É |
| **–¢—Ä–∏–≥–≥–µ—Ä** | –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö (INSERT, UPDATE, DELETE) | –†–µ–∞–ª–∏–∑—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏, –∞—É–¥–∏—Ç –∏ —Ç.–¥. |

> üí° **–°–æ–≤–µ—Ç:** –§—É–Ω–∫—Ü–∏–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ SQL-–∑–∞–ø—Ä–æ—Å–∞—Ö –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä: `SELECT * FROM get_employees()`.

---

## üîπ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã (—Ñ—É–Ω–∫—Ü–∏–∏/–ø—Ä–æ—Ü–µ–¥—É—Ä—ã):
     - –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –æ–¥–∏–Ω —Ä–∞–∑.
     - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ ‚Äî **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è**.
     - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É.
2. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞:**
   - –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ **–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏**, –∞ –Ω–µ –≤–µ—Å—å –Ω–∞–±–æ—Ä SQL-–∫–æ–º–∞–Ω–¥.
3. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏:**
   - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## üîπ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PL/pgSQL

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **PL/pgSQL Engine** ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ PL/pgSQL.
- **SQL Executor** ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. PL/pgSQL-–∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä.
2. –î–≤–∏–∂–æ–∫ –ø–µ—Ä–µ–¥–∞—ë—Ç —ç—Ç–æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä SQL Executor'—É.
3. –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –¥–≤–∏–∂–æ–∫ PL/pgSQL.

üëâ –≠—Ç–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**.

### –í–∞–∂–Ω–æ:
- –ß–∞—Å—Ç–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É PL/pgSQL –∏ SQL Executor —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç:
  - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **SET-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –≤–º–µ—Å—Ç–æ –∫—É—Ä—Å–æ—Ä–æ–≤ –∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

---

## üîπ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏

–ö—Ä–æ–º–µ PL/pgSQL, PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ —è–∑—ã–∫–∏:

| –Ø–∑—ã–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **PL/Perl** | Perl-—Å–∫—Ä–∏–ø—Ç—ã –≤ –ë–î |
| **PL/Python** | Python-–∫–æ–¥ –≤ –ë–î |
| **PL/Tcl** | Tcl-—Å–∫—Ä–∏–ø—Ç—ã –≤ –ë–î |

> –≠—Ç–∏ —è–∑—ã–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–æ–±–Ω—ã, –µ—Å–ª–∏ –≤—ã —É–∂–µ –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∏–º–∏, –Ω–æ PL/pgSQL —è–≤–ª—è–µ—Ç—Å—è **—Ä–æ–¥–Ω—ã–º** –¥–ª—è PostgreSQL –∏ –ª—É—á—à–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω.

---

## üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ PL/pgSQL

(–≠—Ç–æ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–µ–º)

### –ë–ª–æ–∫ PL/pgSQL:
```sql
DO $$
BEGIN
    -- –õ–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
END $$;
```

–ò–ª–∏:
```sql
CREATE OR REPLACE FUNCTION –∏–º—è()
RETURNS —Ç–∏–ø_–≤–æ–∑–≤—Ä–∞—Ç–∞ AS $$
BEGIN
    -- –¢–µ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏
    RETURN ...;
END;
$$ LANGUAGE plpgsql;
```

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
  ```sql
  DECLARE
      counter INTEGER := 0;
      name TEXT;
  ```

- **–£—Å–ª–æ–≤–∏—è:**
  ```sql
  IF —É—Å–ª–æ–≤–∏–µ THEN
      ...
  ELSIF —É—Å–ª–æ–≤–∏–µ THEN
      ...
  ELSE
      ...
  END IF;
  ```

- **–¶–∏–∫–ª—ã:**
  ```sql
  LOOP
      EXIT WHEN —É—Å–ª–æ–≤–∏–µ;
      ...
  END LOOP;

  FOR i IN 1..10 LOOP
      ...
  END LOOP;
  ```

- **–ö—É—Ä—Å–æ—Ä—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ (EXCEPTION):**
  ```sql
  BEGIN
      ...
  EXCEPTION
      WHEN others THEN
          RAISE NOTICE '–û—à–∏–±–∫–∞!';
  END;
  ```

---

## üîπ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é PL/pgSQL

- ‚úÖ **–ü–∏—à–∏—Ç–µ —á–∏—Å—Ç—ã–π –∏ –º–æ–¥—É–ª—å–Ω—ã–π –∫–æ–¥.**
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.**
- ‚úÖ **–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.**
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ.**
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RAISE NOTICE –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.**
- ‚ùå **–ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ –ë–î, –µ—Å–ª–∏ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.**

---
