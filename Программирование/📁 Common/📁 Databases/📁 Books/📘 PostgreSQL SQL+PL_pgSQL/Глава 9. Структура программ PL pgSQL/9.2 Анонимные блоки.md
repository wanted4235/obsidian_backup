## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ –∞–Ω–æ–Ω–∏–º–Ω—ã–π –±–ª–æ–∫?

**–ê–Ω–æ–Ω–∏–º–Ω—ã–π –±–ª–æ–∫** ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ —è–∑—ã–∫–µ PL/pgSQL, –∫–æ—Ç–æ—Ä–∞—è:

- **–ù–µ –∏–º–µ–µ—Ç –∏–º–µ–Ω–∏**
- **–ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
- **–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑**
- **–ö–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ**

### –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –í—ã–∑–æ–≤ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä –∏ —Ñ—É–Ω–∫—Ü–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î

> üí° –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∏–ª–∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

---

## üîπ –°–≤–æ–π—Å—Ç–≤–∞ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –±–ª–æ–∫–æ–≤

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------------|----------|
| –ù–∞–ª–∏—á–∏–µ –∏–º–µ–Ω–∏ | ‚ùå –ù–µ—Ç |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î | ‚ùå –ù–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è |
| –ö–æ–º–ø–∏–ª—è—Ü–∏—è | ‚úÖ –ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ |
| –í—ã–∑–æ–≤ –∏–∑ –¥—Ä—É–≥–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ | ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–µ–Ω |

---

## üîπ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –±–ª–æ–∫–∞

```sql
DO $$
BEGIN
    -- –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
END $$;
```

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª `DECLARE` –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ `EXCEPTION` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫.

---

## üîπ –ü—Ä–∏–º–µ—Ä 1: –†–µ—à–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è (–±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫)

```sql
DO $$
DECLARE
    a real := 1;
    b real := -1;
    c real := -6;
    d real;
    x1 real;
    x2 real;
BEGIN
    d := SQRT(b*b - 4*a*c);
    x1 := (-b - d) / (2*a);
    x2 := (-b + d) / (2*a);

    RAISE NOTICE '–ö–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è: %x¬≤ + %x + % = 0', a, b, c;
    RAISE NOTICE 'x1 = %', x1;
    RAISE NOTICE 'x2 = %', x2;
END $$;
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
NOTICE: –ö–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è: 1x¬≤ + -1x + -6 = 0
NOTICE: x1 = -2
NOTICE: x2 = 3
```

> ‚ö†Ô∏è –≠—Ç–æ—Ç –∫–æ–¥ **–Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏**, –∫–æ–≥–¥–∞ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ‚Üí –≤–æ–∑–º–æ–∂–Ω–∞ –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## üîπ –ü—Ä–∏–º–µ—Ä 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–º–æ—â—å—é EXCEPTION

```sql
DO $$
DECLARE
    a real := -1;
    b real := -1;
    c real := -6;
    d real;
    x1 real;
    x2 real;
    msg text;
    sqlstate text;
BEGIN
    d := SQRT(b*b - 4*a*c);
    x1 := (-b - d) / (2*a);
    x2 := (-b + d) / (2*a);

    RAISE NOTICE 'x1 = %', x1;
    RAISE NOTICE 'x2 = %', x2;

EXCEPTION WHEN OTHERS THEN
    GET STACKED DIAGNOSTICS
        msg = MESSAGE_TEXT,
        sqlstate = RETURNED_SQLSTATE;

    RAISE NOTICE '–û—à–∏–±–∫–∞: %', msg;
    RAISE NOTICE 'SQLSTATE: %', sqlstate;
END $$;
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
NOTICE: –û—à–∏–±–∫–∞: –∏–∑–≤–ª–µ—á—å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –Ω–µ–ª—å–∑—è
NOTICE: SQLSTATE: 2201F
```

> üí° –≠—Ç–æ **—Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –æ—à–∏–±–∫—É**, –Ω–æ –ª—É—á—à–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å —Ç–∞–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –∑–∞—Ä–∞–Ω–µ–µ.

---

## üîπ –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–∞ (–ª—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞)

```sql
DO $$
DECLARE
    a real := -1;
    b real := -1;
    c real := -6;
    d real;
    x1 real;
    x2 real;
BEGIN
    IF (b*b - 4*a*c) >= 0 THEN
        d := SQRT(b*b - 4*a*c);
        x1 := (-b - d) / (2*a);
        x2 := (-b + d) / (2*a);

        RAISE NOTICE '–ö–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è: %x¬≤ + %x + % = 0', a, b, c;
        RAISE NOTICE 'x1 = %', x1;
        RAISE NOTICE 'x2 = %', x2;
    ELSE
        RAISE NOTICE '–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π –Ω–µ—Ç.';
    END IF;
END $$;
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
NOTICE: –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π –Ω–µ—Ç.
```

> ‚úÖ –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ **–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏** –≤–º–µ—Å—Ç–æ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏. –≠—Ç–æ **–ª—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞** –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üîπ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RAISE NOTICE** –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º—è –æ—Ç–ª–∞–¥–∫–∏.
- **–ü–∏—à–∏—Ç–µ –∑–∞—â–∏—Ç—É –æ—Ç –æ—à–∏–±–æ–∫** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏).
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (EXCEPTION)** –Ω—É–∂–Ω–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ ‚Äî –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è **—Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**.
- **–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –±–ª–æ–∫–∏ —É–¥–æ–±–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**, –Ω–æ **–Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**.

---

## üîπ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –±–ª–æ–∫–∏?

‚úÖ –î–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
‚úÖ –î–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π/–ø—Ä–æ—Ü–µ–¥—É—Ä  
‚úÖ –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ª–æ–≥–∏–∫–∏  
‚úÖ –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

