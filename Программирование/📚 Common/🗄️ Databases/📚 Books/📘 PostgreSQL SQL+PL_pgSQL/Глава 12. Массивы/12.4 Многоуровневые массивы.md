# üìå –ö–æ–Ω—Å–ø–µ–∫—Ç: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ (–º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ) –º–∞—Å—Å–∏–≤—ã –≤ PL/pgSQL

## üîπ –í–≤–µ–¥–µ–Ω–∏–µ

–í PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å **–æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º–∏**, –Ω–æ –∏ —Å **–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º–∏ (–º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏)** –º–∞—Å—Å–∏–≤–∞–º–∏. –¢–∞–∫–∏–µ –º–∞—Å—Å–∏–≤—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ **—Ç–∞–±–ª–∏—Ü—ã, –º–∞—Ç—Ä–∏—Ü—ã –∏–ª–∏ –¥–∞–∂–µ —Ç—Ä—ë—Ö–º–µ—Ä–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**.

### –ü—Ä–∏–º–µ—Ä:
```sql
ARRAY[[1, 2], [3, 4]]        -- –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤
ARRAY[[['a','b'], ['c','d']], [['e','f'], ['g','h']]]  -- —Ç—Ä—ë—Ö–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤
```

üìå –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å **1**, –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö.

---

## üîÅ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

| –¢–µ—Ä–º–∏–Ω | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| –û–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ | –°–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (–≤–µ–∫—Ç–æ—Ä) |
| –î–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ | –¢–∞–±–ª–∏—Ü–∞ –∑–Ω–∞—á–µ–Ω–∏–π (–º–∞—Ç—Ä–∏—Ü–∞) |
| –¢—Ä—ë—Ö–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ | –ö—É–± –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã x, y, z) |
| `array_length(array, dim)` | –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è |
| `array_ndims(array)` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π –º–∞—Å—Å–∏–≤–∞ |

---

## üî∏ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏

### 1. **–û–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞**

```sql
DO $$
DECLARE
    matrix INTEGER[][] := ARRAY[[1, 2], [3, 4]];
BEGIN
    RAISE NOTICE '–ú–∞—Ç—Ä–∏—Ü–∞: %', matrix;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: –ú–∞—Ç—Ä–∏—Ü–∞: {{1,2},{3,4}}
```

> ‚úÖ –≠—Ç–æ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ ‚Äî –∞–Ω–∞–ª–æ–≥ —Ç–∞–±–ª–∏—Ü—ã.

---

### 2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π**

```sql
DO $$
DECLARE
    arr1 INTEGER[] := ARRAY[1, 2];
    arr2 INTEGER[][] := ARRAY[[1, 2], [3, 4]];
    arr3 INTEGER[][][] := ARRAY[[[1, 2], [3, 4]], [[5, 6], [7, 8]]];
BEGIN
    RAISE NOTICE '–ò–∑–º–µ—Ä–µ–Ω–∏–π arr1: %', array_ndims(arr1);
    RAISE NOTICE '–ò–∑–º–µ—Ä–µ–Ω–∏–π arr2: %', array_ndims(arr2);
    RAISE NOTICE '–ò–∑–º–µ—Ä–µ–Ω–∏–π arr3: %', array_ndims(arr3);
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: –ò–∑–º–µ—Ä–µ–Ω–∏–π arr1: 1
NOTICE: –ò–∑–º–µ—Ä–µ–Ω–∏–π arr2: 2
NOTICE: –ò–∑–º–µ—Ä–µ–Ω–∏–π arr3: 3
```

> ‚úÖ –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∞—Å—Å–∏–≤–∞ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π.

---

### 3. **–î–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞**

```sql
DO $$
DECLARE
    matrix INTEGER[][] := ARRAY[[1, 2], [3, 4]];
BEGIN
    RAISE NOTICE 'matrix[1][1] = %', matrix[1][1];
    RAISE NOTICE 'matrix[2][2] = %', matrix[2][2];
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: matrix[1][1] = 1
NOTICE: matrix[2][2] = 4
```

> ‚úÖ –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1.

---

### 4. **–ü–µ—Ä–µ–±–æ—Ä –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–∏–∫–ª–æ–≤**

```sql
DO $$
DECLARE
    matrix INTEGER[][] := ARRAY[[1, 2], [3, 4]];
    i INTEGER;
    j INTEGER;
BEGIN
    FOR i IN 1..array_length(matrix, 1) LOOP
        FOR j IN 1..array_length(matrix, 2) LOOP
            RAISE NOTICE 'matrix[%][%] = %', i, j, matrix[i][j];
        END LOOP;
    END LOOP;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: matrix[1][1] = 1
NOTICE: matrix[1][2] = 2
NOTICE: matrix[2][1] = 3
NOTICE: matrix[2][2] = 4
```

> ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–ª–æ–∂–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º.

---

### 5. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä—ë—Ö–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞**

```sql
DO $$
DECLARE
    cube INTEGER[][][] := ARRAY[
        [[1, 2], [3, 4]],
        [[5, 6], [7, 8]]
    ];
    i INTEGER;
    j INTEGER;
    k INTEGER;
BEGIN
    FOR i IN 1..array_length(cube, 1) LOOP
        FOR j IN 1..array_length(cube, 2) LOOP
            FOR k IN 1..array_length(cube, 3) LOOP
                RAISE NOTICE 'cube[%][%][%] = %', i, j, k, cube[i][j][k];
            END LOOP;
        END LOOP;
    END LOOP;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: cube[1][1][1] = 1
NOTICE: cube[1][1][2] = 2
NOTICE: cube[1][2][1] = 3
NOTICE: cube[1][2][2] = 4
NOTICE: cube[2][1][1] = 5
NOTICE: cube[2][1][2] = 6
NOTICE: cube[2][2][1] = 7
NOTICE: cube[2][2][2] = 8
```

> ‚úÖ –¢—Ä—ë—Ö–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ–∏ –∏–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã xyz.

---

### 6. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤**

```sql
DO $$
DECLARE
    matrix INTEGER[][] := ARRAY[[1, 2], [3, 4]];
BEGIN
    matrix := array_cat(matrix, ARRAY[[5, 6]]);
    RAISE NOTICE '–ù–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞: %', matrix;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: –ù–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞: {{1,2},{3,4},{5,6}}
```

> ‚úÖ `array_cat()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏.

---

### 7. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞**

```sql
DO $$
DECLARE
    matrix INTEGER[][] := ARRAY[[1, 2], [3, 4], [5, 6]];
    new_matrix INTEGER[][];
    i INTEGER;
BEGIN
    FOR i IN 1..array_length(matrix, 1) LOOP
        IF i != 2 THEN
            new_matrix := array_cat(new_matrix, ARRAY[matrix[i]]);
        END IF;
    END LOOP;

    RAISE NOTICE '–ú–∞—Å—Å–∏–≤ –±–µ–∑ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏: %', new_matrix;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE: –ú–∞—Å—Å–∏–≤ –±–µ–∑ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏: {{1,2},{5,6}}
```

> ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –±–µ–∑ –Ω—É–∂–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

| –°–æ–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| –ò—Å–ø–æ–ª—å–∑—É–π `array_length(array, dim)` | –ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è |
| –ò—Å–ø–æ–ª—å–∑—É–π –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ | –û—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è 2D –∏ 3D |
| –ù–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é —Å 1 | –≠—Ç–æ –≤–∞–∂–Ω–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º |
| –ò—Å–ø–æ–ª—å–∑—É–π `array_cat` –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ | –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Å–±–æ—Ä–∫—É –Ω–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ | –ü–æ—Å–∫–æ–ª—å–∫—É –º–∞—Å—Å–∏–≤—ã –≤ PostgreSQL –Ω–µ–∏–∑–º–µ–Ω–Ω—ã |

---

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|------------|----------------------|
| 1D (–æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π) | –°–ø–∏—Å–∫–∏, –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö |
| 2D (–¥–≤—É–º–µ—Ä–Ω—ã–π) | –¢–∞–±–ª–∏—Ü—ã, –º–∞—Ç—Ä–∏—Ü—ã |
| 3D (—Ç—Ä—ë—Ö–º–µ—Ä–Ω—ã–π) | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ–∏, 3D-–≥—Ä–∞—Ñ–∏–∫–∞ |

–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–∞—Å—Å–∏–≤—ã ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ PL/pgSQL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏, –∏–º–µ—é—â–∏–º–∏ —Å–ª–æ–∂–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –û–Ω–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω—ã –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏, —Ç—Ä–µ–±—É—é—â–∏–º–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏.

---
