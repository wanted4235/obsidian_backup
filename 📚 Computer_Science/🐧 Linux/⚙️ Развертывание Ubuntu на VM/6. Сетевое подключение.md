## NAT

Первый способ организации сетевого подключения - [[Сетевое подключение - NAT]]. Для того, чтобы настроить его требуется:
	1. Зайти в настройки виртуальной машины
	2. Выбрать пункт "Сеть"
	3. В адаптере выбрать тип подключения "[[Сетевое подключение - NAT]]"
Если после этого мы запустим нашу виртуальную машину, мы можем ввести команду "ip a". Нам отобразится информация об ip - адресах и сетевых интерфейсах:
- 127.0.0.1 - внутренний адрес localhost машины на которой мы работаем. 
- 10.0.2.15 - внутренняя сеть, которая доступна только внутри нашей виртуальной машины, из вне она недоступна. (находясь на компьютере, в нашем случае Windows мы к этому адресу подключиться не можем)
Можно проверить:
```bash 
ssh user1@10.0.2.15
```
Для того, чтобы иметь [[Сетевое подключение - NAT]] и иметь возможность подключения, мы должны зайти в настройки адаптера и выполнить проброс портов.

| Имя         | Протокол | Адрес хоста | Порт хоста | Адрес гостя | Порт гостя |     |
| ----------- | -------- | ----------- | ---------- | ----------- | ---------- | --- |
| SSH connect | TCP      | 22          |            |             | 22         |     |
> Если мы имеем несколько виртуальных машин, мы не можем их все пробросить через один порт, так как машина-хост имеет только 1 порт, который мы занимаем. В данном случае только один 22 порт. 

Теперь мы можем подключить, но только через внутренний адрес хост машины:
```bash 
ssh user1@127.0.0.1
```
 
Второй способ подключения - на своей хост-машине набираем "ipconfig" и смотрим параметр IPv4-адрес. В моём случае - 192.168.1.74 . 
Разница между 127.0.0.1 и 192.168.1.74 заключается в том, что первый - доступен только самой машине, а второй это адрес внутренней локальной сети, созданной роутером (приватная сеть). Если мы подключены к той же локальной сети по wi-fi или через кабель к роутеру, то мы также сможем подключиться к виртуальной машине. 

---

## Bridge 

Сетевой мост [[Сетевое подключение - Bridge]] - связывает карту виртуальной машины с картой компьютера, по которому мы подключаемся к интернету. При выборе [[Сетевое подключение - Bridge]] он сам определяет карту, через которую мы подключаемся к сети.
После переподключения мы вводим команду "ip a" и увидим что мы получили новый ip-адрес, который похож на IPv4-адрес, машины хоста, похожее на 192.168..... т.е. наша виртуальная машина получила тот же ip-адрес, в котором находится наша хост-машина, следовательно более пробрасывать порты не нужно, т.к. мы находимся в той же сети. Проверить подключение можно:
```bash
ssh user1@192.168.0.108 (адрес гостевой машины Ubuntu Server)
```

---

## Виртуальный адаптер хоста

[[Сетевое подключение - виртуальный адаптер хоста]] даёт стабильное подключение между машиной хостом и гостевой машиной. Она практически не зависит от внешней среды, в отличии от сетевого моста. Минус заключается в том, что он создан для соединения между хостом и гостем, но не для получения интернета. 
После выбора данного адаптера мы запускаем виртуальную машину и вводим "ip a" и видим новый ip-адрес, по которому можем соединится с машиной.
Проверить подключение можно: 
```bash 
ssh user1@192.168.56.101
```
но если мы попробуем обновить пакеты:
```bash
sudo apt update
```
Мы получим ошибку подключения.

---

## Лучший способ стабильного подключения

В первый сетевой адаптер мы выбираем [[Сетевое подключение - NAT]] для стабильного подключение к интернету, а вторым адаптером мы добавим - [[Сетевое подключение - виртуальный адаптер хоста]] для стабильным соединением между хостом и гостевой машиной. 
После выбора подключения таким способом и запуском виртуальной машины, мы набираем команду "ip a" и видим, что 3 интерфейс не настроен, его нужно настроить вручную. Для этого отредактируем файл конфигурации:
```bash
sudo nano /etc/netplan/50-cloud-init.yaml
```
дополняем файл по названию 3-интерфейса, который берём из команды "ip a", например его название "enp0s8":
```yaml 
network:
  ethernets:
    enp0s3:
      dhcp4: true
    enp0s8:
	  dhcp4: true
  version: 2
```
Выполняем перезагрузку:
```bash 
sudo reboot
```
Проверка работоспособности интернета:
```bash 
sudo apt update
```
Проверка соединения, по ip-адресу 3-го интерфейса:
```bash 
ssh user1@192.168.56.101
```
