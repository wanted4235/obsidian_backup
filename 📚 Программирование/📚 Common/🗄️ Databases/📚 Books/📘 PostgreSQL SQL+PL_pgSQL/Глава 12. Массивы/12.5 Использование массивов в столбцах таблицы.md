# üìå –ö–æ–Ω—Å–ø–µ–∫—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö —Ç–∞–±–ª–∏—Ü—ã

## üîπ –í–≤–µ–¥–µ–Ω–∏–µ

–í PostgreSQL **–º–∞—Å—Å–∏–≤—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞:

- –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–≥–∏, –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, –ª—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–∞)
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ –∏ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã –≤—Å–µ—Ö –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

---

## üîÅ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å –º–∞—Å—Å–∏–≤–∞–º–∏ | `CREATE TABLE ... (col TYPE[])` |
| –í—Å—Ç–∞–≤–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤ | `INSERT INTO ... VALUES (ARRAY[...])` |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ | `UPDATE ... SET col[i] = ...` |
| –ó–∞–ø—Ä–æ—Å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ | `SELECT col[i] FROM table` |
| –ü–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–∏ –º–∞—Å—Å–∏–≤–∞ | `WHERE col @> ARRAY[...]` –∏–ª–∏ `= ANY(...)` |
| –ê–≥—Ä–µ–≥–∞—Ü–∏—è –≤ –º–∞—Å—Å–∏–≤ | `SELECT array_agg(col) FROM table` |

---

## üî∏ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

### 1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –º–∞—Å—Å–∏–≤–æ–º**

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name TEXT,
    hobbies TEXT[]
);
```

üìå –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–ø–∏—Å–æ–∫ —Ö–æ–±–±–∏.

---

### 2. **–í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –º–∞—Å—Å–∏–≤–æ–º**

```sql
INSERT INTO users (name, hobbies)
VALUES
    ('–ê–ª–µ–∫—Å–µ–π', ARRAY['—Ñ—É—Ç–±–æ–ª', '–º—É–∑—ã–∫–∞']),
    ('–ú–∞—Ä–∏—è', ARRAY['—Ä–∏—Å–æ–≤–∞–Ω–∏–µ', '–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è']),
    ('–î–º–∏—Ç—Ä–∏–π', ARRAY['–∏–≥—Ä—ã', '–∫–∏–Ω–æ']);
```

üìå –•–æ–±–±–∏ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø–æ–ª–µ ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω–æ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ.

---

### 3. **–í—ã–±–æ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞**

```sql
SELECT name, hobbies[1] AS first_hobby
FROM users;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
   name   | first_hobby
----------|-------------
 –ê–ª–µ–∫—Å–µ–π  | —Ñ—É—Ç–±–æ–ª
 –ú–∞—Ä–∏—è    | —Ä–∏—Å–æ–≤–∞–Ω–∏–µ
 –î–º–∏—Ç—Ä–∏–π  | –∏–≥—Ä—ã
```

> ‚úÖ –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1.

---

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞**

```sql
UPDATE users
SET hobbies[2] = '–ø–ª–∞–≤–∞–Ω–∏–µ'
WHERE name = '–ê–ª–µ–∫—Å–µ–π';
```

üìå –¢–µ–ø–µ—Ä—å —É –ê–ª–µ–∫—Å–µ—è –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ ‚Äî ¬´–ø–ª–∞–≤–∞–Ω–∏–µ¬ª.

---

### 5. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤**

```sql
UPDATE users
SET hobbies = array_append(hobbies, '–∫–Ω–∏–≥–∏')
WHERE name = '–ú–∞—Ä–∏—è';
```

üìå –¢–µ–ø–µ—Ä—å —É –ú–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ —Ö–æ–±–±–∏ ‚Äî ¬´–∫–Ω–∏–≥–∏¬ª.

---

### 6. **–£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞**

```sql
UPDATE users
SET hobbies = array_remove(hobbies, '–∫–∏–Ω–æ')
WHERE name = '–î–º–∏—Ç—Ä–∏–π';
```

üìå –£ –î–º–∏—Ç—Ä–∏—è —É–¥–∞–ª–µ–Ω–æ —Ö–æ–±–±–∏ ¬´–∫–∏–Ω–æ¬ª.

---

### 7. **–ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–µ–π –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞**

#### a) –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–Ω–∞—á–µ–Ω–∏—è:
```sql
SELECT * FROM users
WHERE hobbies @> ARRAY['—Ñ—É—Ç–±–æ–ª'];
```

üìå –í–µ—Ä–Ω—ë—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å ¬´—Ñ—É—Ç–±–æ–ª¬ª –≤ —Å–ø–∏—Å–∫–µ —Ö–æ–±–±–∏.

#### b) –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ `ANY`):
```sql
SELECT * FROM users
WHERE '—Ä–∏—Å–æ–≤–∞–Ω–∏–µ' = ANY(hobbies);
```

üìå –¢–∞–∫–∂–µ –≤–µ—Ä–Ω—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ö–æ–±–±–∏ ¬´—Ä–∏—Å–æ–≤–∞–Ω–∏–µ¬ª.

---

### 8. **–ü–µ—Ä–µ–±–æ—Ä –º–∞—Å—Å–∏–≤–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –≤ PL/pgSQL**

```sql
DO $$
DECLARE
    user_rec RECORD;
    hobby TEXT;
BEGIN
    FOR user_rec IN SELECT name, hobbies FROM users LOOP
        RAISE NOTICE '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: %', user_rec.name;

        FOREACH hobby IN ARRAY user_rec.hobbies LOOP
            RAISE NOTICE ' - –•–æ–±–±–∏: %', hobby;
        END LOOP;
    END LOOP;
END $$;
```

üìå –≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ —Ö–æ–±–±–∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.

---

### 9. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –º–∞—Å—Å–∏–≤**

```sql
SELECT array_agg(name) AS all_names
FROM users;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
{"–ê–ª–µ–∫—Å–µ–π","–ú–∞—Ä–∏—è","–î–º–∏—Ç—Ä–∏–π"}
```

üìå –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ —Å–ø–∏—Å–∫–∞ –∏–º—ë–Ω, ID –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤.

---

### 10. **–•—Ä–∞–Ω–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤**

```sql
CREATE TABLE student_scores (
    student_id SERIAL PRIMARY KEY,
    scores INTEGER[]
);

INSERT INTO student_scores (scores)
VALUES
    (ARRAY[4, 5, 3]),
    (ARRAY[5, 5, 5]);

SELECT student_id, scores[2] AS second_score
FROM student_scores;
```

üìå –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏, –±–∞–ª–ª—ã, –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –¥—Ä—É–≥–∏–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

### 11. **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ**

```sql
CREATE TABLE matrix_data (
    id SERIAL PRIMARY KEY,
    matrix INTEGER[][]
);

INSERT INTO matrix_data (matrix)
VALUES (ARRAY[[1, 2], [3, 4]]);

SELECT matrix[1][2] FROM matrix_data;
-- –í—ã–≤–µ–¥–µ—Ç: 2
```

üìå –¢–∞–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—á—ë—Ç–æ–≤, –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Ç.–¥.

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

| –°–æ–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| –ù–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–π –º–∞—Å—Å–∏–≤–∞–º–∏ –≤–º–µ—Å—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–π | –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã |
| –ò—Å–ø–æ–ª—å–∑—É–π `@>` –∏ `= ANY()` –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–Ω—É—Ç—Ä–∏ –º–∞—Å—Å–∏–≤–æ–≤ | –û–Ω–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –∏ –ø—Ä–æ—Å—Ç—ã –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ |
| –ò—Å–ø–æ–ª—å–∑—É–π `array_agg()` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ | –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤ |
| –ò—Å–ø–æ–ª—å–∑—É–π `FOREACH` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–æ–≤ –≤ PL/pgSQL | –≠—Ç–æ —Å–∞–º—ã–π —á–∏—Ç–∞–µ–º—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–±–æ—Ä–∞ |
| –î–æ–±–∞–≤–ª—è–π –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –º–∞—Å—Å–∏–≤—ã, –µ—Å–ª–∏ —á–∞—Å—Ç–æ –∏—â–µ—à—å –ø–æ –Ω–∏–º | –ù–∞–ø—Ä–∏–º–µ—Ä: `CREATE INDEX idx ON users USING GIN(hobbies)` |

---

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|------------|---------------------|
| `TEXT[]`, `INTEGER[]` –∏ —Ç.–ø. | –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ |
| `@>` | –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ |
| `= ANY()` | –î–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ –º–∞—Å—Å–∏–≤–µ |
| `array_agg()` | –î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞—Å—Å–∏–≤ |
| `FOREACH` | –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–æ–≤ –≤ PL/pgSQL |
| –î–≤—É–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã | –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ |

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö —Ç–∞–±–ª–∏—Ü ‚Äî –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º PostgreSQL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –±–µ–∑ –ª–∏—à–Ω–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏. –û—Å–æ–±–µ–Ω–Ω–æ —É–¥–æ–±–µ–Ω –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å PL/pgSQL –∏ —Ö—Ä–∞–Ω–∏–º—ã–º–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏.

---
