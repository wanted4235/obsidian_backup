## üîπ –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º PL/pgSQL

–í—Å–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ —è–∑—ã–∫–µ **PL/pgSQL** —Å–æ—Å—Ç–æ—è—Ç –∏–∑ **–±–ª–æ–∫–æ–≤**.

### –ß—Ç–æ —Ç–∞–∫–æ–µ –±–ª–æ–∫?
- –≠—Ç–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏.
- –ë–ª–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å **–æ–¥–Ω–∏–º**, –∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å **–≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∏–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏**.
- –í –æ–¥–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –±–ª–æ–∫–æ–≤.

---

## üîπ –¢–∏–ø—ã –±–ª–æ–∫–æ–≤

| –¢–∏–ø –±–ª–æ–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **–ê–Ω–æ–Ω–∏–º–Ω—ã–π –±–ª–æ–∫** | –ù–µ –∏–º–µ–µ—Ç –∏–º–µ–Ω–∏, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —Ä–∞–∑–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏. |
| **–ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫** | –Ø–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é **—Ö—Ä–∞–Ω–∏–º–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏**. –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –≤—ã–∑–≤–∞–Ω –ø–æ –∏–º–µ–Ω–∏. |

> üí° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
> - –ê–Ω–æ–Ω–∏–º–Ω—ã–π –±–ª–æ–∫ ‚Äî –æ—Ç–ª–∞–¥–∫–∞ –ª–æ–≥–∏–∫–∏.
> - –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫ ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –≤ –ë–î.

---

## üîπ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ–∫–∞ PL/pgSQL

```sql
[DECLARE]
-- –†–∞–∑–¥–µ–ª –æ–±—ä—è–≤–ª–µ–Ω–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
BEGIN
  -- –í—ã–ø–æ–ª–Ω—è–µ–º—ã–π —Ä–∞–∑–¥–µ–ª (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
  -- –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ –ª–æ–≥–∏–∫–∞
[EXCEPTION]
  -- –†–∞–∑–¥–µ–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
END;
```

### –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ä–∞–∑–¥–µ–ª–∞—Ö:

1. **DECLARE**
   - –°–æ–¥–µ—Ä–∂–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è:
     - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
     - –ö—É—Ä—Å–æ—Ä–æ–≤
     - –õ–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º
     - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
   - –ù–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.

2. **BEGIN ... END**
   - –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã.
   - –°–æ–¥–µ—Ä–∂–∏—Ç:
     - SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (`SELECT`, `INSERT`, `UPDATE`, `DELETE`)
     - –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (`IF`, `LOOP`, `CASE`)
     - –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è
   - **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª.** –î–∞–∂–µ –µ—Å–ª–∏ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä.

3. **EXCEPTION**
   - –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ `BEGIN`, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å—é–¥–∞.
   - –ù–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏.

---

## üîπ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ PL/pgSQL

PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:

| –¢–∏–ø | –°–∏–Ω—Ç–∞–∫—Å–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|-----------|------------|
| –û–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π | `--` | –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –≤—Å—ë –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏ |
| –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π | `/* ... */` | –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –ª—é–±–æ–π –±–ª–æ–∫ –∫–æ–¥–∞ |

–ü—Ä–∏–º–µ—Ä:
```sql
-- –≠—Ç–æ –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

/* –≠—Ç–æ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π
–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */
```

---

## üîπ –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: RAISE NOTICE

–î–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:

```sql
RAISE NOTICE '–¢–µ–∫—Å—Ç % [%]', –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è1, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è2;
```

### –ü—Ä–∏–º–µ—Ä:
```sql
DO $$
DECLARE
    name TEXT := '–ò–≤–∞–Ω';
    age INTEGER := 30;
BEGIN
    RAISE NOTICE '–ò–º—è: %, –í–æ–∑—Ä–∞—Å—Ç: %', name, age;
END $$;
```

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NOTICE:  –ò–º—è: –ò–≤–∞–Ω, –í–æ–∑—Ä–∞—Å—Ç: 30
```

> üí° –ü–æ–ª–µ–∑–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä –∏ —Ñ—É–Ω–∫—Ü–∏–π.

---

## üîπ –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **–í—ã–ø–æ–ª–Ω—è–µ–º—ã–π —Ä–∞–∑–¥–µ–ª (`BEGIN...END`) ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.**
- **–û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚Äî –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.**
- **–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —É–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å.**
- **–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤ –ø–æ–º–Ω–∏ –ø—Ä–æ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.**

---

## üîπ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –±–ª–æ–∫–∞ PL/pgSQL

```sql
DO $$
DECLARE
    counter INTEGER := 0;
BEGIN
    counter := counter + 1;
    RAISE NOTICE '–°—á—ë—Ç—á–∏–∫ = %', counter;
END $$;
```

üìå –≠—Ç–æ—Ç –∞–Ω–æ–Ω–∏–º–Ω—ã–π –±–ª–æ–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `counter` –Ω–∞ 1 –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

